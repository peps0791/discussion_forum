<html>
	<head>
		<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="  crossorigin="anonymous"></script>
		<script src = "/jquery-highlight.js"></script>
		<link href="/jquery.upvote.css" rel="stylesheet">
		<script src = "/jquery.upvote.js" type="text/javascript"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="/style.css"/>
		<script src="/createlinks.js"></script>
		<script src="/textaudit.js"></script>
		<script src="/PorterStemmer1980.min.js"></script>
		<script src="/highlight.js"></script>
		<title id = 'pagetitle'>Robot Veering to the Left
		</title>
	</head>
	<body id = 'pagebody'>
		<div id = "loginmodals"></div>
		<div id = "issuemodals"></div>
		<div id = "highlight_tool"></div>
		<div class = "container">
			<header>
				<h1>Just Another Discussion Forum</h1>
			</header>
			<div class="topnav" id="myTopnav">
				<a href="/home">Home</a>
				<a href = "#issueModal" data-toggle="modal" style = "float:right">Report Issue</a>
			</div>
			<div class = "content">
			<div id = "ques-12129" class = "post">
			<h2>Question</h2>
			<div id="vote-12129" class="upvote" style="float:left;">
				<a class="upvote"></a>
				<span class="count">1</span>
				<a class="downvote"></a>
				<a class="star"></a>
				<p>Views :: 53</p>
			</div>
			<form id = "questionpostsform" method="GET" action = "/ask">
				<input type="submit" id = "quesbtn" class="btn btn-primary btn-lg" value="Ask Question">
			</form>
				<h2>Robot Veering to the Left</h2>
<p>I'm currently programming in RobotC, for a Vex 2.0 Cortex. I'm using encoders to make my robot go straight.</p>

<p>This is my code:</p>

<pre><code>#pragma config(I2C_Usage, I2C1, i2cSensors)
#pragma config(Sensor, dgtl2,  ,               sensorDigitalIn)
#pragma config(Sensor, dgtl7,  ,               sensorDigitalOut)
#pragma config(Sensor, I2C_1,  ,               sensorQuadEncoderOnI2CPort,    , AutoAssign )
#pragma config(Sensor, I2C_2,  ,               sensorQuadEncoderOnI2CPort,    , AutoAssign )
#pragma config(Motor,  port1,           RM,            tmotorVex393_HBridge, openLoop, reversed, encoderPort, I2C_2)
#pragma config(Motor,  port10,          LM,            tmotorVex393_HBridge, openLoop, encoderPort, I2C_1)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

/* Port 1 is right motor*/

//all functions expect no reverse motors (in port menu)
//**GLOBAL VARIABLES**
int buttonSTATE = 0;

//**MOVE FUNCTIONS**
void goforwards(int time)
{
    int Tcount = 0;
    int speed1 = 30;
    int speed2 = 30;
    int difference = 5;


    motor[LM] = speed1;
    motor[RM] = speed2;
    while (Tcount &lt; time)
    {
        nMotorEncoder[RM] = 0;
        nMotorEncoder[LM] = 0;

        while(nMotorEncoder[RM]&lt;3000)
        {
            int REncoder = -nMotorEncoder[RM];
            int LEncoder = -nMotorEncoder[LM];

            if (LEncoder &gt; REncoder)
            {
                motor[LM] = speed1 - difference;
                motor[RM] = speed2 + difference;    
            }
            if (LEncoder &lt; REncoder)
            {
                motor[LM] = speed1 + difference;
                motor[RM] = speed2 - difference;
            }
            wait1Msec(100);
        }
        Tcount ++;
    }
}

//**CONTROL STRUCTURE:**
task main()
{

    goforwards(1);
}
</code></pre>

<p>When I execute the code, the Robot's encoder values are very close, but the robot quickly starts to veer to the left. What are possible causes of this? Is it something in the code?</p>

			</div>
			<div class = "userinfosection"  id = "userinfo-12129" data-toggle = "popover">
				<p>user name : nosn</p>
				<p> user reputation : 13</p>
				<p class = "tagcontent" id = "usertaginfo-12129">{'None': 0, 'quadrature-encoder': 1, 'vex': 1, 'mobile-robot': 1, 'robotc': 2, 'movement': 1}</p>
			</div><br>
			<br><h3>Comments</h3>
				<button data-toggle = 'collapse' data-target = "#commentsection-12129">Load Comments</button></br>
			<div id = "commentsection-12129" class = 'collapse'>
			<div id = "comment-21481" class = "comment">
				<p>Can you log and read the left and right motor speed values? If the speeds are close to each other, the remaining drift can be because of the vehicle itself. The CG, tire frictions, etc.</p>
			</div>
			</div>
				<textarea id = "speech-12129" rows="3" cols="80"></textarea><br>
				<button class="record-start" id="start-12129">
					<img id="start_img-12129" src="/mic.gif" alt="Start">
				</button>
				<button class = "comment-btn" id = "comment-btn-12129">Comment</button>

<h1>Answers</h1>
			<br><div id = "ans-12131"  class = "post">
				<h2>Answer</h2>
			<div id="vote-12131" class="upvote" style="float:left;">
				<a class="upvote"></a>
				<span class="count">1</span>
				<a class="downvote"></a>
				<a class="star"></a>
			</div>
				<p><p>Lets suppose, that left wheel is blocked, so <code>nMotorEncoder[LM]</code> is constantly zero, while <code>nMotorEncoder[RM]</code> counts something. Correct behavior is for right motor to effectively stop (or jumping little back and forth the same lenght).</p>

<p>Now <code>LEncoder</code> is 0, <code>REncoder</code> is negative, <code>LEncoder &gt; REncoder</code> so</p>

<pre><code>            motor[LM] = speed1 - difference;
            motor[RM] = speed2 + difference;
</code></pre>

<p>left motor slowes, right motor goes faster. This is not, what you want, in next step <code>nMotorEncoder[RM]</code> goes positive again (<code>nMotorEncoder[LM]</code> is still zero), right motor tries to move faster, while left motor tries to be even slower. Soon left motor is going backward full speed, right motor going forward full speed, no stabilizing.</p>

<p>Usually the motor are not totally equal (and usually they turn one way better, than the opposite way), so it is possible, that your left motor is a little slower/weaker, than right. Even if it is not much and can be compensated for, the way you are doing it is making it more and more visible.</p>

<p>Try to remove the minuses on </p>

<pre><code>        int REncoder = -nMotorEncoder[RM];
        int LEncoder = -nMotorEncoder[LM];
</code></pre>

<p>of change the direction of comparing <code>LEncoder &gt; REncoder</code> </p>

<p>BTW: I am not sure, but you probably also should limit the maximal/minimal speed</p>
</p><br>
			</div>
			<div class = "userinfosection"  id = "userinfo-12131" data-toggle = "popover">
				<p>user name : gilhad</p>
				<p> user reputation : 362</p>
				<p class = "tagcontent" id = "usertaginfo-12131">{'control': 0, 'mobile-robot': 0, 'None': 18, 'arm': -1, 'robotic-arm': -1}</p>
			</div><br><h3>Comments</h3><p>no comments yet<p><br>
			<div id = "commentsection-12131" class = 'collapse'>
			</div>
				<textarea id = "speech-12131" rows="3" cols="80"></textarea><br>
				<button class="record-start" id="start-12131">
					<img id="start_img-12131" src="/mic.gif" alt="Start">
				</button>
				<button class = "comment-btn" id = "comment-btn-12131">Comment</button>
			<br><div id = "ans-12187"  class = "post">
				<h2>Answer</h2>
			<div id="vote-12187" class="upvote" style="float:left;">
				<a class="upvote"></a>
				<span class="count">1</span>
				<a class="downvote"></a>
				<a class="star"></a>
			</div>
				<p><p>There are 4 possibilities:</p>

<ol>
<li><p>One of the wheels' centre is displaced slightly.</p></li>
<li><p>Wheel encoders are not properly positioned and this is causing issues (like wheel pausing at odd positions while microcontroller 'thinks' it has achieved the right position)</p></li>
<li><p>One of the wheels' radius is lesser than the other one.</p></li>
<li><p>As per @GurkanSetin 's comment, friction might be causing some issue.</p></li>
</ol>

<p>It is better to timestamp every count (some counts are getting missed probably) and post logs here and use some sort of feedback; preferably imaging and using some sort of minimal localisation to correct that; preferably something like this <a href="https://www.ais.uni-bonn.de/papers/ICRA_2008_Orthogonal_Wall_Correction.pdf" rel="nofollow noreferrer">https://www.ais.uni-bonn.de/papers/ICRA_2008_Orthogonal_Wall_Correction.pdf</a> . Even visual SLAM can be used. Some 'basic' tutorial can be found here: <a href="https://ocw.mit.edu/courses/aeronautics-and-astronautics/16-412j-cognitive-robotics-spring-2005/projects/1aslam_blas_repo.pdf" rel="nofollow noreferrer">https://ocw.mit.edu/courses/aeronautics-and-astronautics/16-412j-cognitive-robotics-spring-2005/projects/1aslam_blas_repo.pdf</a> (Some people place one camera sideways - orthogonal to motion of robot for monocular vision and just use template matching/image-difference)</p>
</p><br>
			</div>
			<div class = "userinfosection"  id = "userinfo-12187" data-toggle = "popover">
				<p>user name : Prasad Raghavendra</p>
				<p> user reputation : 146</p>
				<p class = "tagcontent" id = "usertaginfo-12187">{'quadcopter': 3, 'None': 10, 'simulation': 3, 'ros': 3, 'gazebo': 3, 'software': 3}</p>
			</div><br><h3>Comments</h3><p>no comments yet<p><br>
			<div id = "commentsection-12187" class = 'collapse'>
			</div>
				<textarea id = "speech-12187" rows="3" cols="80"></textarea><br>
				<button class="record-start" id="start-12187">
					<img id="start_img-12187" src="/mic.gif" alt="Start">
				</button>
				<button class = "comment-btn" id = "comment-btn-12187">Comment</button>
			<br><div id = "ans-14057"  class = "post">
				<h2>Answer</h2>
			<div id="vote-14057" class="upvote" style="float:left;">
				<a class="upvote"></a>
				<span class="count">0</span>
				<a class="downvote"></a>
				<a class="star"></a>
			</div>
				<p><p>You can troubleshoot, send some value which lock at certain speed to left motor and read the speed,
Send same vlaues to right motor and again read the speed again.
Compare results,Watch for current draw in both the cases.</p>

<p>Try switching the channel of motors on bridge.</p>

<p>If the values are same and you get different speed, then there should be problem in hardware.</p>
</p><br>
			</div>
			<div class = "userinfosection"  id = "userinfo-14057" data-toggle = "popover">
				<p>user name : Mudassir Hussain</p>
				<p> user reputation : 1</p>
				<p class = "tagcontent" id = "usertaginfo-14057">{'None': 0}</p>
			</div><br><h3>Comments</h3><p>no comments yet<p><br>
			<div id = "commentsection-14057" class = 'collapse'>
			</div>
				<textarea id = "speech-14057" rows="3" cols="80"></textarea><br>
				<button class="record-start" id="start-14057">
					<img id="start_img-14057" src="/mic.gif" alt="Start">
				</button>
				<button class = "comment-btn" id = "comment-btn-14057">Comment</button>
			</div>
			<div id = "resourcestab" class = "resourcestab">
				<ul class="nav nav-tabs">
					<li class="active"><a data-toggle="tab" href="#resources">Resources</a></li>
					<li><a data-toggle="tab" href="#summary">Summary</a></li>
				</ul>
					<div class="tab-content">
						<div id="resources" class="tab-pane fade in active">
							<h3>Resources</h3>
							<div id = "resourcescontent"></div>
						</div>
						<div id="summary" class="tab-pane fade">
							<h3>Summary</h3>
							<div id = "summarycontent"></div>
						</div>
			</div>
			</div>
			<footer>Moore & Peps collaboration.</footer>
	</div>
	<script src="/post.js"></script>
	<script type="text/javascript">
		$("#loginmodals").load("/loginModal.html");
		$("#issuemodals").load("/issueModal.html");
		$("#highlight_tool").load("/highlight_tool.html");
		checkLoggedInUser()
		var content = $('.content').html();
		populateResources(content)
		getHighlights()
		setOnLinksHover()
	</script>
	<script src="/media.js"></script>
	<script src="/vote.js"></script>
	<script src="/managefunction.js"></script>
	</body>
</html>