<html>
	<head>
		<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="  crossorigin="anonymous"></script>
		<script src = "/jquery-highlight.js"></script>
		<link href="/jquery.upvote.css" rel="stylesheet">
		<script src = "/jquery.upvote.js" type="text/javascript"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="/style.css"/>
		<script src="/createlinks.js"></script>
		<script src="/textaudit.js"></script>
		<script src="/PorterStemmer1980.min.js"></script>
		<script src="/highlight.js"></script>
		<title id = 'pagetitle'>Programming 4-digit seven segment display using interrupts only
		</title>
	</head>
	<body id = 'pagebody'>
		<div id = "loginmodals"></div>
		<div id = "issuemodals"></div>
		<div id = "highlight_tool"></div>
		<div id = "comment_tool"></div>
		<div class = "container">
			<header>
				<h1>Just Another Discussion Forum</h1>
			</header>
			<div class="topnav" id="myTopnav">
				<a href="/home">Home</a>
				<a href = "#issueModal" data-toggle="modal" style = "float:right">Report Issue</a>
			</div>
			<div class = "content">
			<div id = "ques-9218" class = "post">
			<h2>Question</h2>
			<div id="vote-9218" class="upvote" style="float:left;">
				<a class="upvote"></a>
				<span class="count">1</span>
				<a class="downvote"></a>
				<a class="star"></a>
				<p>Views :: 300</p>
			</div>
			<form id = "questionpostsform" method="GET" action = "/ask">
				<input type="submit" id = "quesbtn" class="btn btn-primary btn-lg" value="Ask Question">
			</form>
				<h2>Programming 4-digit seven segment display using interrupts only</h2>
<p>I have to program an autonomous bot (using an ATmega2560). It has a 4-digit seven segment display attached to it. I have to make the bot traverse through arena while continuously displaying the time in seconds on the seven segment display.</p>

<p>I can't use the code to display on seven segment display in my <code>main()</code> function.</p>

<p>Any help? </p>

			</div>
			<div class = "userinfosection"  id = "userinfo-9218" data-toggle = "popover">
				<p>user name : Shivendra Singh Vishen</p>
				<p> user reputation : 13</p>
				<p class = "tagcontent" id = "usertaginfo-9218">{'None': 0, 'dynamic-programming': 1, 'first-robotics': 0, 'mobile-robot': 1, 'automatic': 1, 'interrupts': 1}</p>
			</div><br>
			<br><h3>Comments</h3>
				<button data-toggle = 'collapse' data-target = "#commentsection-9218">Load Comments</button></br>
			<div id = "commentsection-9218" class = 'collapse'>
			<div id = "comment-16307" class = "comment">
				<p>First, I think the most common meaning of "ssd" is solid state drive. Please spell out what you mean. Second, how are you driving the display? Communication with a driver chip or are you powering each segment individually? If comms to a driver chip, what's the protocol? Third, why can't you update the display in your main code?</p>
			</div>
			<div id = "comment-16312" class = "comment">
				<p>Welcome to *robotics* Shivendra Singh Vishen. On stack exchange, questions asking for homework help must include a summary of the work you've done so far to solve the problem, and a description of the difficulty you are having solving it. Please edit your question to add this information. Take a look at [ask] and [about] for more information on how stack exchange works. For advice on how to write a good question, see the [*Robotics* question checklist](http://meta.robotics.stackexchange.com/q/1302/37).</p>
			</div>
			</div>
				<textarea id = "speech-9218" rows="3" cols="80"></textarea><br>
				<button class="record-start" id="start-9218">
					<img id="start_img-9218" src="/mic.gif" alt="Start">
				</button>
				<button class = "comment-btn" id = "comment-btn-9218">Comment</button>

<h1>Answers</h1>
			<br><div id = "ans-9221"  class = "post">
				<h2>Answer</h2>
			<div id="vote-9221" class="upvote" style="float:left;">
				<a class="upvote"></a>
				<span class="count">3</span>
				<a class="downvote"></a>
				<a class="star"></a>
			</div>
				<p><p>While this question may seem to be better suited for SE Arduino, I shall, nevertheless, propose a solution. Employ a ready written Arduino library, as this would save a lot of groundwork. Granted, as you mention that you have a <code>main()</code>, then one can assume that you are not using the Arduino IDE. However, the library (with the <code>.cpp</code> file and <code>.h</code> file) can still be used.</p>

<p>Interestingly, I went through the pain of coding up a seven segment display last year, on the Arduino, albeit only a two digit display, an SL-1255 (see <a href="https://gr33nonline.wordpress.com/2015/08/04/dual-seven-segment-display-madness/" rel="nofollow">Dual Seven Segment display madness</a>). I even came up with an all singing and dancing Arduino library, <a href="https://github.com/greenonline/SevenSegmentSL1255" rel="nofollow">SevenSegmentSL1255</a>. </p>

<p>However, I do not recommend you using it, as it does not use interrupts and, much to my <em>chagrin</em>, I found another, more fully featured, seven segment display Arduino library, <a href="http://playground.arduino.cc/Main/SevenSeg" rel="nofollow">SevenSeg</a>, after having completed mine. The SevenSeg library will work with four digit displays and it also handles interrupt driven displays.</p>

<p>From section 4.4 <strong>Using Interrupt Timers</strong> of the <a href="http://sim.marebakken.com/SevenSeg.pdf" rel="nofollow">PDF</a>, </p>

<blockquote>
  <p>Running the printing functions in an endless loop to perform multiplexing is not always an ideal way to do things. Outputting information to a 7-segment display is not a computationally intensive task, but due to the delay used for multiplexing, the microcontroller just sits there and waits for most of the time. Sure, you can insert commands taking little time in a loop together with the printing functions, but if they are slightly time-consuming, the display will halt or flicker. For this purpose it is possible to use SevenSegalong with interrupt timers. Then, you can do whatever you want inside <code>loop(){...}</code>, and simply run a high-level printing function only when you want to change what's on the display. The microcontroller will automatically be interrupted just briefly to update the display as needed. You can still change the refresh rate and the duty cycle like normal, the SevenSeg-library will take care of configuring the timers for you.</p>
</blockquote>

<p>The library code can be downloaded from <a href="http://sim.marebakken.com/SevenSeg.zip" rel="nofollow">here</a>.</p>

<p>An example sketch (again taken from section 4.4 of the PDF) is as follows:</p>

<pre><code>#include &lt;SevenSeg.h&gt;
SevenSeg disp(11,7,3,5,6,10,2);
const int numOfDigits =4;
int digitPins[numOfDigits]={12,9,8,13};

void setup () {
  disp.setDigitPins(numOfDigits ,digitPins);
  disp.setTimer(2); disp.startTimer();
}

void loop() {
  for(int i=1;i&lt;=10;i++){
    disp.write(i);
    delay(1000); // Or other time-consuming tasks
  }
}

ISR(TIMER2_COMPA_vect) { 
  disp.interruptAction();
}
</code></pre>

<p>Obviously, you will need to modify the sketch for your particular purposes, notably either calling <code>setup()</code> and <code>loop()</code> from your <code>main()</code>, or incorporating the display updates from the <code>loop()</code> into your <code>main()</code>.</p>

<p>However, please make particular note of the Interrupt Service Routine (ISR), as this is what you require: <code>ISR(TIMER2_COMPA_vect) {disp.interruptAction();}</code>. This will ensure that you have a flicker free display, while the processor is performing processor intensive tasks, when controlling your bot.</p>
</p><br>
			</div>
			<div class = "userinfosection"  id = "userinfo-9221" data-toggle = "popover">
				<p>user name : Greenonline</p>
				<p> user reputation : 1053</p>
				<p class = "tagcontent" id = "usertaginfo-9221">{'None': 44, 'arduino': 3, 'stepper-motor': 7, 'mechanism': 0, 'rcservo': 13}</p>
			</div><br><h3>Comments</h3><p>no comments yet<p><br>
			<div id = "commentsection-9221" class = 'collapse'>
			</div>
				<textarea id = "speech-9221" rows="3" cols="80"></textarea><br>
				<button class="record-start" id="start-9221">
					<img id="start_img-9221" src="/mic.gif" alt="Start">
				</button>
				<button class = "comment-btn" id = "comment-btn-9221">Comment</button>
			</div>
			<div id = "resourcestab" class = "resourcestab">
				<ul class="nav nav-tabs">
					<li class="active"><a data-toggle="tab" href="#resources">Resources</a></li>
					<li><a data-toggle="tab" href="#summary">Summary</a></li>
					<li><a data-toggle="tab" href="#highlights">Highlights</a></li>
				</ul>
					<div class="tab-content">
						<div id="resources" class="tab-pane fade in active">
							<h3>Links from the Page</h3>
							<div id = "resourcescontent"></div>
						</div>
						<div id="summary" class="tab-pane fade">
							<h3>Summary</h3>
							<div id = "summarycontent"></div>
						</div>
						<div id="highlights" class="tab-pane fade">
							<h3>Highlights</h3>
							<div id = "highlightcontent"></div>
						</div>
			</div>
			</div>
			<footer>Moore & Peps collaboration.</footer>
	</div>
	<script src="/post.js"></script>
	<script type="text/javascript">
		$("#loginmodals").load("/loginModal.html");
		$("#issuemodals").load("/issueModal.html");
		$("#highlight_tool").load("/highlight_tool.html");
		$("#comment_tool").load("/comment_tool.html");
		checkLoggedInUser()
		var content = $('.content').html();
		populateResources(content)
		getHighlights()
		setOnLinksHover()
	</script>
	<script src="/media.js"></script>
	<script src="/vote.js"></script>
	<script src="/managefunction.js"></script>
	</body>
</html>