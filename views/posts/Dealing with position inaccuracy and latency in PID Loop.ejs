<html>
	<head>
		<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="  crossorigin="anonymous"></script>
		<script src = "/jquery-highlight.js"></script>
		<link href="/jquery.upvote.css" rel="stylesheet">
		<script src = "/jquery.upvote.js" type="text/javascript"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="/style.css"/>
		<script src="/createlinks.js"></script>
		<script src="/textaudit.js"></script>
		<script src="/PorterStemmer1980.min.js"></script>
		<script src="/highlight.js"></script>
		<title id = 'pagetitle'>Dealing with position inaccuracy and latency in PID Loop
		</title>
	</head>
	<body id = 'pagebody'>
		<div id = "loginmodals"></div>
		<div id = "issuemodals"></div>
		<div id = "highlight_tool"></div>
		<div class = "container">
			<header>
				<h1>Just Another Discussion Forum</h1>
			</header>
			<div class="topnav" id="myTopnav">
				<a href="/home">Home</a>
				<a href = "#issueModal" data-toggle="modal" style = "float:right">Report Issue</a>
			</div>
			<div class = "content">
			<div id = "ques-6355" class = "post">
			<h2>Question</h2>
			<div id="vote-6355" class="upvote" style="float:left;">
				<a class="upvote"></a>
				<span class="count">3</span>
				<a class="downvote"></a>
				<a class="star"></a>
				<p>Views :: 272</p>
			</div>
			<form id = "questionpostsform" method="GET" action = "/ask">
				<input type="submit" id = "quesbtn" class="btn btn-primary btn-lg" value="Ask Question">
			</form>
				<h2>Dealing with position inaccuracy and latency in PID Loop</h2>
<p>Background:
I am new to PID, for my first PID project I am using a simple P-Loop and 300 degree linear potentiometers for position feedback. I am using the roboclaw 2x60A motor controller.  The motor controller has 64 speeds between.  Sometimes the potentiometers can vary as much as +-4 degrees when not in motion.  I am using an Arduino mega with a 10bit ADC to control the motors.  </p>

<p>My Question:
How can I filter or reduce the variance in the potentiometers?  In addition, it takes a certain amount of time for the motors to react to the command, and it seems to throw off the P loop.  How do I account for the latency, in my program?</p>

<p>Example:
For this example the P loop was run every 33-36 milliseconds.
I will tell the motor to go to 250 deg/sec, and it will go to 275 deg/sec, the P loop then reacts by lowering the value sent to the motor however the speed then increase to 400 deg/sec and then the P loop lowers the value again, then the speed will drop to 34 deg/sec.</p>

<p>Thanks so much for any help,
Joel</p>

			</div>
			<div class = "userinfosection"  id = "userinfo-6355" data-toggle = "popover">
				<p>user name : Joel</p>
				<p> user reputation : 125</p>
				<p class = "tagcontent" id = "usertaginfo-6355">{'control': 1, 'None': 0, 'noise': 0, 'encoding': 1, 'arduino': 3, 'microcontroller': 1, 'pid': 3, 'avr': 3, 'motor': 4, 'electronics': 0, 'motion-planning': 1, 'driver': 0, 'software': 3}</p>
			</div><br>
			<br><h3>Comments</h3>
				<button data-toggle = 'collapse' data-target = "#commentsection-6355">Load Comments</button></br>
			<div id = "commentsection-6355" class = 'collapse'>
			<div id = "comment-9226" class = "comment">
				<p>You should move your update into an answer to your own question so that we can upvote it.</p>
			</div>
			</div>
				<textarea id = "speech-6355" rows="3" cols="80"></textarea><br>
				<button class="record-start" id="start-6355">
					<img id="start_img-6355" src="/mic.gif" alt="Start">
				</button>
				<button class = "comment-btn" id = "comment-btn-6355">Comment</button>

<h1>Answers</h1>
			<br><div id = "ans-6359"  class = "post">
				<h2>Answer</h2>
			<div id="vote-6359" class="upvote" style="float:left;">
				<a class="upvote"></a>
				<span class="count">3</span>
				<a class="downvote"></a>
				<a class="star"></a>
			</div>
				<p><p>Having only the proportional term of the PID regulator will most definitely leave you with oscillations. If you think about it, it's quite similar to a linear harmonic oscillator F=k*x (formula for spring motion). Adding a derivative term should damp out those oscillations. If after waiting for the system to stabilize you see it stabilized with some offset and not the value you've instructed it to, you'll need to add integral term as well in order to remove that constant error.</p>

<p>As for the shaky ground, try separating logic power supply from the motors' power supply, and using optocouplers where possible. It's a common problem.</p>

<p>Regards,
Damjan</p>
</p><br>
			</div>
			<div class = "userinfosection"  id = "userinfo-6359" data-toggle = "popover">
				<p>user name : Damjan Dakic</p>
				<p> user reputation : 650</p>
				<p class = "tagcontent" id = "usertaginfo-6359">{'control': 6, 'None': 32, 'sensor-fusion': 5, 'localization': 5, 'rcservo': 3, 'pid': 6, 'automation': 0, 'servomotor': 3, 'differential-drive': 6, 'design': 3, 'kalman-filter': 5, 'sensors': 5, 'pwm': 3, 'navigation': 6}</p>
			</div><br><h3>Comments</h3><p>no comments yet<p><br>
			<div id = "commentsection-6359" class = 'collapse'>
			</div>
				<textarea id = "speech-6359" rows="3" cols="80"></textarea><br>
				<button class="record-start" id="start-6359">
					<img id="start_img-6359" src="/mic.gif" alt="Start">
				</button>
				<button class = "comment-btn" id = "comment-btn-6359">Comment</button>
			<br><div id = "ans-6397"  class = "post">
				<h2>Answer</h2>
			<div id="vote-6397" class="upvote" style="float:left;">
				<a class="upvote"></a>
				<span class="count">0</span>
				<a class="downvote"></a>
				<a class="star"></a>
			</div>
				<p><p>Update:
After more debugging I have traced the variance in the potentiometer to a shaky ground in the Roboclaw 2x60a motor controller.  When I connect the ground to the Roboclaw the potentiometers vary by +-4 through +-6 degrees when the ground is not connected to the Roboclaw the pots vary by +- 1 sometimes rarely +- 2.  I have tried using the arduino as a logic battery and it doesn't help.</p>
</p><br>
			</div>
			<div class = "userinfosection"  id = "userinfo-6397" data-toggle = "popover">
				<p>user name : Joel</p>
				<p> user reputation : 125</p>
				<p class = "tagcontent" id = "usertaginfo-6397">{'control': 1, 'None': 0, 'noise': 0, 'encoding': 1, 'arduino': 3, 'microcontroller': 1, 'pid': 3, 'avr': 3, 'motor': 4, 'electronics': 0, 'motion-planning': 1, 'driver': 0, 'software': 3}</p>
			</div><br><h3>Comments</h3><p>no comments yet<p><br>
			<div id = "commentsection-6397" class = 'collapse'>
			</div>
				<textarea id = "speech-6397" rows="3" cols="80"></textarea><br>
				<button class="record-start" id="start-6397">
					<img id="start_img-6397" src="/mic.gif" alt="Start">
				</button>
				<button class = "comment-btn" id = "comment-btn-6397">Comment</button>
			</div>
			<div id = "resourcestab" class = "resourcestab">
				<ul class="nav nav-tabs">
					<li class="active"><a data-toggle="tab" href="#resources">Resources</a></li>
					<li><a data-toggle="tab" href="#summary">Summary</a></li>
				</ul>
					<div class="tab-content">
						<div id="resources" class="tab-pane fade in active">
							<h3>Resources</h3>
							<div id = "resourcescontent"></div>
						</div>
						<div id="summary" class="tab-pane fade">
							<h3>Summary</h3>
							<div id = "summarycontent"></div>
						</div>
			</div>
			</div>
			<footer>Moore & Peps collaboration.</footer>
	</div>
	<script src="/post.js"></script>
	<script type="text/javascript">
		$("#loginmodals").load("/loginModal.html");
		$("#issuemodals").load("/issueModal.html");
		$("#highlight_tool").load("/highlight_tool.html");
		checkLoggedInUser()
		var content = $('.content').html();
		populateResources(content)
		getHighlights()
		setOnLinksHover()
	</script>
	<script src="/media.js"></script>
	<script src="/vote.js"></script>
	<script src="/managefunction.js"></script>
	</body>
</html>